{
  "hash": "6a32b41dcad77a9e973a3225f65a66d2",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"More Efficient Working\"\nsubtitle: \"A guide to standardising scripts\" \nauthor: \"Corey Voller\"\ndate: \"2024-01-28\"\ntoc: true\ntoc-expand: 3\ncategories: [R, code, Working Practices]\nimage: \"image.jpg\"\n---\n\n\n\n\n# What are snippets?\n\nA useful way to cut-down the amount of repetitive typing is through the use of snippets. My love of snippets is primarily fueled by my inherent laziness (If any future employers are reading this I'm joking). A snippet allows you to automatically insert pieces of code. When I mention custom snippets to people they have often never heard of them but you likely use them without knowing and can be very useful. For example, when I type 'for' and press tab, I am met with the following chunk of code.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfor (variable in vector) {\n  \n}\n```\n:::\n\n\n\n\nThere are numerous pre-defined snippets that exist in the settings already but we can insert our own customised snippets. You can see some larger snippets on my GitHub [here](https://github.com/cgvoller/standardisingScripts).\n\n# Motivation\n\nTo anyone who has QC'd code, they will understand the frustration of loading up a script and seeing a huge mess of disjointed code with a lack of structure and comments (Not mentioning any names - I am far from perfect myself!). As part of having good coding practices, I believe it is good to have consistency and fluency across scripts, not just for an individual but across a team. This is where snippets can be useful, I can load up a script template which will be consistent across my projects and work and therefore easier to navigate across them.\n\n# How to add custom snippets\n\nWithin RStudio, navigate to the top and click Tools -\\> Global Options and select the code tab on the left. It should look something like this:\n\n![](options.jpg){fig-align=\"center\" width=\"652\"}\n\nEnsure that snippets is ticked at the bottom and click 'Edit Snippets'.\n\nNext, add in your custom snippet by typing 'snippet' followed by whatever name you choose for it and its functionality. The word snippet should be left aligned and coloured purple as seen below for my snippet 'pastefile'.\n\n![](snippet_menu.JPG){fig-align=\"center\" width=\"631\" height=\"629\"}\n\nTo use your custom snippets, begin typing the name of the snippet into the script and you should see it appear with brackets `{snippet}` . Press 'tab' and it should load/execute the snippet.\n\n![](test.jpg){fig-align=\"center\" width=\"737\"}\n\n# Examples\n\n## Change \\\\ to / when pasting file paths\n\nThe first snippet is fairly trivial but surprisingly useful in day-to-day working.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsnippet pastefile\n\t\"`r gsub('\"', \"\", gsub(\"\\\\\\\\\", \"/\", readClipboard()))`\"\n```\n:::\n\n\n\n\nWhen copying and pasting file paths in R you are often met with backslashes which R complains about. The above snippet, when you copy a file path and type 'pastefile' it will past the file path location with forward slashes instead.\n\n## Generic Script Template 1\n\nThis is a generic script template with a few features. Firstly, at the top I like to define a few things:\n\n1.  Path of the project\n2.  Overall purpose of the script\n3.  Who wrote the script\n4.  Date (which is taken automatically using `sys.time()`)\n5.  Who and when the code has been QC'd\n\nYou'll also notice I use `## text ----`. The reason for this is it creates section headers which make navigating code easier.\n\n![](sections.JPG){fig-align=\"center\" width=\"745\"}\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsnippet header\n\t## ─────────────────────────────────────────────────────────────────────────────\n\t##\n\t## Project: `r paste(gsub(\".*STUDY FOLDER/\",\"\",getwd()))`\n\t##\n\t## Purpose of script:\n\t##\n\t## Author: \n\t##\n\t## Date Created: `r paste(format(Sys.time(), \"%d-%m-%Y\"))`\n\t##\n\t## QC'd by:\n\t## QC date:\n\t##\n\t## ─────────────────────────────────────────────────────────────────────────────\n\t##\n\t## Notes:\n\t##   \n\t##\n\t## ─────────────────────────────────────────────────────────────────────────────\n\t##\n\t## \n\t## set working directory -------------------------------------------------------\n\tmessage(\"Set working directory\")\n\n\t# setwd(\"~/\")  \n\t\n\t## Options ---------------------------------------------------------------------\n\t\n\t# options(scipen = 6, digits = 4) # View outputs in non-scientific notation\n\n\t## Load packages ---------------------------------------------------------------\n\tmessage(\"Load packages\")\n\n\t## Set file paths --------------------------------------------------------------\n\tmessage(\"Set file paths\")\n\n\tbase.path <- \"\"\n\tdata.path <- \"\"\n\toutput.path <- \"\"\n\ttemplate.path <- \"\"\n\n\n\t## Load data -------------------------------------------------------------------\n\tmessage(\"Load data\")\n\t \n\t# data <- fread(file.path(data.path, \".csv\")) # or read.csv, etc\n\t# load(x,file.path(data.path,\".RData\"))\n\t# load(file.path(\"C:/Users/isfar.RData\"), isfar_env <- new.env())\n\n\n\t## First Section ---------------------------------------------------------------\n\tmessage(\"First Section\")\n\n\t## Second Section --------------------------------------------------------------\n\tmessage(\"Second Section\")\n\n\n\t## Third Section ---------------------------------------------------------------\n\tmessage(\"Third section\")\n\n\n\t## Output  ---------------------------------------------------------------------\n\tmessage(\"Output\")\n\n\t# save(x,file.path(output.path,\".RData\"))\n\t# write.csv(x,file.path(output.path,\"x.csv\")\n```\n:::\n\n\n\n\n\n## Fancy template\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsnippet templatefancy\n\t## ─────────────────────────────────────────────────────────────────────────────\n\t##\n\t## Project: `r paste(gsub(\".*STUDY FOLDER/\",\"\",getwd()))`\n\t##\n\t## Purpose of script:\n\t##\n\t## Author: `r paste(Sys.info()[[\"user\"]])`\n\t##\n\t## Date Created: `r paste(format(Sys.time(), \"%d-%m-%Y\"))`\n\t## R Version: `r paste(R.Version()$version.string)`\n\t## Copyright: (c) `r paste(Sys.info()[[\"user\"]],format(Sys.time(), \"%d-%m-%Y\"))`\n\t## Licence: <Licence details >\n\t##\n\t## QC'd by:\n\t## QC date:\n\t##\n\t## ─────────────────────────────────────────────────────────────────────────────\n\t##\n\t## Notes:\n\t##   \n\t##\n\t## ─────────────────────────────────────────────────────────────────────────────\n\t##\n\t## \n\t## set working directory -------------------------------------------------------\n\tmessage(\"Set working directory\")\n\n\t# If you're using an R project file, file paths will be relative so this is not \n\t# needed.\n\t# setwd(\"~/\")  \n\t\n\t## Options ---------------------------------------------------------------------\n\t\n\t# options(scipen = 6, digits = 4) # View outputs in non-scientific notation\n\t\n\n\t## Source config ---------------------------------------------------------------\n\tmessage(\"Source config\")\n\n\t# Set up libraries, R options for outputs, read in in-house functions\n\tsource(\"progs/config.R\")\n\n\t## Set file paths --------------------------------------------------------------\n\tmessage(\"Set file paths\")\n\n\tbase.path <- \"\"\n\tdata.path <- \"\"\n\toutput.path <- \"\"\n\ttemplate.path <- \"\"\n\n\n\t## Load data -------------------------------------------------------------------\n\tmessage(\"Load data\")\n\t \n\t# data <- fread(file.path(data.path, \".csv\")) # or read.csv, etc\n\t# load(x,file.path(data.path,\".RData\"))\n\t# load(file.path(\"C:/Users/isfar.RData\"), isfar_env <- new.env())\n\n\n\t## First Section ---------------------------------------------------------------\n\tmessage(\"First Section\")\n\n\t## Second Section --------------------------------------------------------------\n\tmessage(\"Second Section\")\n\n\t## Output  ---------------------------------------------------------------------\n\tmessage(\"Output\")\n\n\t# save(x,file.path(output.path,\".RData\"))\n\t# write.csv(x,file.path(output.path,\"x.csv\")\n```\n:::\n\n\n\n\n## Config Script Template\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsnippet configtemplate\n\t## ─────────────────────────────────────────────────────────────────────────────\n\t##\n\t## Project: `r paste(gsub(\".*STUDY FOLDER/\",\"\",getwd()))`\n\t##\n\t## Purpose of script:\n\t##\n\t## Author: \n\t##\n\t## Date Created: `r paste(format(Sys.time(), \"%d-%m-%Y\"))`\n\t##\n\t## QC'd by:\n\t## QC date:\n\t##\n\t## ─────────────────────────────────────────────────────────────────────────────\n\t##\n\t## Notes:\n\t##   \n\t##\n\t## ─────────────────────────────────────────────────────────────────────────────\n\t##\n\t## \n\t## Preliminary -----------------------------------------------------------------\n\tmessage(\"Preliminary\")\n\n\t# Remove objects from workspace\n\trm(list = ls())\n\t\n\t## Options ---------------------------------------------------------------------\n\t\n\toptions(verbose = TRUE, stringsAsFactors = FALSE)\n\n\t## Load packages ---------------------------------------------------------------\n\tmessage(\"Load packages\")\n\t# List of packages to be used\n\tpackages <-\n\t  c(\n\t\t\t\"magrittr\",\n\t\t\t\"dplyr\",\n\t\t\t\"tidyr\",\n\t\t\t\"ggplot2\",\n\t\t\t\"dplyr\",\n\t\t\t\"lubridate\",\n\t\t\t\"RODBC\",\n\t\t\t\"data.table\",\n\t\t\t\"stringr\",\n\t\t\t\"grid\",\n\t\t\t\"gridExtra\"\n\t\t\t)\n\n\n\t# Install cctu package (needs devtools)\n\t# Install packages which aren't installed in \"packages\"\n\t# if (length(packages[!(packages %in% installed.packages()[, \"Package\"])]))\n\t#   install.packages(packages[!(packages %in% installed.packages()[, \"Package\"])])\n\t# Load packages\n\tlapply(packages, library, character.only = TRUE)\n\n\t# source functions from sub folder functions\n\tfile.sources = list.files(\n\tc(\"progs/functions\"),\n\tpattern = \"\\\\.R$\",\n\tfull.names = TRUE,\n\tignore.case = T\n\t)\n\n\tsapply(file.sources,source)\n\t# define theme for figures\n\tdefault_theme <- theme_get()\n\n\tgraphical_theme <- theme_bw() + theme(\n\t axis.line.x      = element_line(color = \"black\")\n\t axis.line.y      = element_line(color = \"black\"),\n\t panel.grid.major = element_blank() ,\n\t panel.grid.minor = element_blank(),\n\t panel.background = element_blank(),\n\t # panel.border = element_blank(),\n\t # axis.text = element_text(size = rel(1), angle = 45)\n\t axis.title.x     = element_text(margin = margin(t = 10)),\n\t legend.key       = element_rect(colour = \"white\", fill = NA),\n\t strip.background = element_rect(colour = \"black\")\n\t)\n```\n:::\n\n\n\n\n\n## End header\n\nDynamically adds dashes to the width of the script.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsnippet endhead\n\t`r paste0(rep.int(\"-\", 88 - rstudioapi::primary_selection(rstudioapi::getActiveDocumentContext())$range$start[2]), collapse = \"\")`\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}